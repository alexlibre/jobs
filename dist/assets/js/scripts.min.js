
"use strict";

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }

$(document).ready(function () {
  hideHeader();

  enableSignIn();

  enableFormSwitch();

  makeFav();

  //   refreshProfileProgress();

  onHover();

  openCatalogItem();

  openCatItem();

  enableCollapse();

  // enableFAQ();

  searchInFaq();

  initSelects();

  dropzone();

  dropzoneDocument();

  enableMenu();

  circleProgressSlider(9000, ".js-company-slider", ".block--vacancies-slider .progress");
  circleProgressSlider(9000, ".js-article-slider", ".js-article-circle");
  circleProgressSlider(9000, ".js-companies-carousel", ".js-companies-circle");

  footerSubscript();

  //   popups();

  hidePortfolioEl();

  showPortfolioEl();

  viewAllSertificates();

  innerPopup();

  addCoverLetter();

  // openEducationForm();

  galleryInit(5000);

  autoComplete();

  validateForm();

  getPosFilterBtn();

  delLetterTemplate();

  // handlingSendingData();

  mobMenu();

  profileCompleteHint();

  // handleEduBlocks();
  // handleJobBlocks();
  handleResumeBlockEdits();

  mobFilter();

  btnMob();

  changeButtonName();

  mobFaq();

  popup();

  jsDel();

  jsCancel();

  //   addSelect();

  submitProfileForms();

  handleVacancyForm();

  handleCardForms();
});

var handleResumeBlockEdits = function handleResumeBlockEdits() {
  var addCardBtn = $(".js-resume-add-card");
  var viewAllCardsBtn = $(".js-cards-view-all");
  var editCardBtn = $(".js-edit-card");

  $("body").on("click", ".js-edit-card", function (e) {
    var form = $(this).parents(".js-resume-block").find(".js-edit-form");
    var ready = $(this).parents(".js-resume-block").find(".js-resume-ready-block");
    var id = $(this)[0].dataset.id;
    var datas = $(this).parents(".js-get-data").find(".js-data");
    var newForm = form[0].cloneNode(true);

    form[0].parentNode.replaceChild(newForm, form[0]);

    TweenMax.to($(ready), 0.4, {
      y: "100",
      opacity: 0,
      height: 0,
      display: "none"
    });

    TweenMax.fromTo($(newForm), 0.4, {
      opacity: 0,
      display: "none",
      height: 0,
      y: 100
    }, {
      y: "0",
      height: "auto",
      display: "block",
      opacity: 1,
      visibility: "visible"
    });
    showProfilePreferencesEditModal(id);
  });

  $("body").on("click", ".js-cards-view-all", function (e) {
    var form = $(this).parents(".js-resume-block").find(".js-edit-form");
    var ready = $(this).parents(".js-resume-block").find(".js-resume-ready-block");
    var cards = $(this).parents(".js-resume-block").find(".resume__block-card");

    if ($(this).hasClass("is-opened")) {
      $(this).html("+ View all");
      $(this).removeClass("is-opened");
      TweenMax.to($(cards).splice(2), 0.4, {
        y: -50,
        opacity: 0,
        height: 0,
        display: "none"
      });
    } else {
      $(this).html("- Collapse");
      $(this).addClass("is-opened");
      TweenMax.staggerFromTo($(cards).splice(2), 0.4, {
        y: -50
      }, {
        y: 0,
        opacity: 1,
        height: "auto",
        display: "block"
      }, 0.1);
    }
  });

  $("body").on("click", ".js-resume-add-card", function () {
    var form = $(this).parents(".js-resume-block").find(".js-edit-form");
    var ready = $(this).parents(".js-resume-block").find(".js-resume-ready-block");
    var id = $(this)[0].dataset.id;
    [].concat(_toConsumableArray(form[0].querySelectorAll("select"))).forEach(function (item) {
      if (item.classList.contains("select2-hidden-accessible")) {
        $(item).select2("destroy");
      }
      return item;
    });

    var newForm = form[0].cloneNode(true);
    [].concat(_toConsumableArray(newForm.querySelectorAll(".js-input-data"))).forEach(function (item) {
      item.value = "";
      return item;
    });
    //I added this
    [].concat(_toConsumableArray(newForm.querySelectorAll("select"))).forEach(function (item) {
      initSelects(item);
      return item;
    });
    //finish
    form[0].parentNode.replaceChild(newForm, form[0]);

    TweenMax.to($(ready), 0.4, {
      y: "100",
      opacity: 0,
      height: 0,
      display: "none"
    });

    TweenMax.fromTo($(newForm), 0.4, {
      opacity: 0,
      display: "none",
      height: 0,
      y: 100
    }, {
      y: "0",
      height: "auto",
      display: "block",
      opacity: 1,
      visibility: "visible"
    });
    showProfilePreferencesModal();
  });

  $("body").on("click", $(".js-del-new-block"), function (e) {
    var self = e.target.closest(".js-del-new-block");
    if (self) {
      var form = $(self).parents(".js-resume-block").find(".js-edit-form");
      var ready = $(self).parents(".js-resume-block").find(".js-resume-ready-block");

      TweenMax.to($(form), 0.4, {
        y: 100,
        opacity: 0,
        height: 0,
        display: "none"
      });

      TweenMax.fromTo($(ready), 0.4, {
        opacity: 0,
        display: "none",
        height: 0
      }, {
        y: 0,
        height: "auto",
        display: "flex",
        opacity: 1,
        visibility: "visible"
      });
    }
  });
};

function hideHeader() {
  // Hide Header on on scroll down
  var didScroll = void 0;
  var lastScrollTop = 0;
  var delta = 5;
  var navbarHeight = $(".header").outerHeight();

  $(window).scroll(function (event) {
    didScroll = true;
  });

  setInterval(function () {
    if (didScroll) {
      hasScrolled();
      didScroll = false;
    }
  }, 250);

  function hasScrolled() {
    var st = $(window).scrollTop();
    if (Math.abs(lastScrollTop - st) <= delta) {
      return false;
    }

    if (st > lastScrollTop && st > navbarHeight) {
      $("header").removeClass("nav-down").addClass("nav-up");
    } else {
      if (st + $(window).height() < $(document).height()) {
        $("header").removeClass("nav-up").addClass("nav-down");
      }
    }

    lastScrollTop = st;
  }
}

function enableSignIn() {
  var visible = void 0;
  var popUp = $(".sign-in__popup");
  var pwdRecovery = $(".sign-in__recover-pwd");
  var resRecovery = $(".sign-in__recover-res");
  var states = [popUp, pwdRecovery, resRecovery];
  var emailTmp = "";

  function hideAll(arr) {
    arr.forEach(function (item) {
      item.slideUp(300);
    });
  }

  function addEvent(trigger, state) {
    return function () {
      $("body").on("click", trigger, function (e) {
        hideAll(states);
        state.slideDown(300);
        visible = state;
      });
    };
  }

  function hideEmail(str) {
    var tmp = str.split(/(.+)@(.+)\.(.+)/).map(function (item) {
      return item.substring(0, 1) + item.substring(1).replace(/./gi, "*");
    }).slice(0, -1);
    var res = void 0;
    if (tmp[1]) {
      res = tmp[1] + "@" + tmp.slice(2).join(".");
      return res;
    }
    return false;
  }

  $("body").on("click", function (e) {
    if (e.target.closest(".js-sign-in-btn") && !visible) {
      popUp.slideToggle(300);
      $(".header__sign-in").toggleClass("is-active");
      $(".js-burger").removeClass("is-active");
      $(".js-mob-menu").removeClass("is-active");
      $("body").removeClass("is-unscrolled");
      visible = popUp;
    } else if (e.target.closest(".sign-in__popup") || e.target.closest(".sign-in__recover-pwd") || e.target.closest(".sign-in__recover-res")) {
      // if (!e.target.closest(".sign-in__popup button[type='submit']"))
      //   return false;
    } else {
      hideAll(states);
      visible = "";
      $(".header__sign-in").removeClass("is-active");
    }
  });

  $("body").on("change", "#recover-email", function () {
    emailTmp = hideEmail($("#recover-email").val());
    document.querySelector(".js-res-email").innerHTML = "" + emailTmp;
  });

  addEvent(".js-recover-pwd", pwdRecovery)();
  addEvent(".js-back-to-sign-in", popUp)();
  addEvent(".js-send-recovery", resRecovery)();
}

function enableFormSwitch() {
  $("body").on("click", "[data-tab]", function (e) {
    e.preventDefault();
    $(this).addClass("is-active").siblings("[data-tab]").removeClass("is-active");
    $("[data-content=" + $(this).data("tab") + "]").addClass("is-active").siblings("[data-content]").removeClass("is-active");
  });
}

function makeFav() {
  $("body").on("click", ".js-make-fav", function (e) {
    if (!$(this).closest(".js-open-catalog-item.is-active")) return false;
    var favId = $(this).attr("data-fav-id");
    var favUrl = $(this).attr("data-fav-url");
    if (!$(this).hasClass("is-active")) {
      $(this).addClass("is-active");

      $.ajax({
        type: "get",
        url: window.location.origin + "/add-to-" + favUrl + $(this).attr("id"),
        success: function success() {
          $('[data-fav-id="' + favId + '"]').addClass("is-active");
        }
      });
    } else {
      $(this).removeClass("is-active");
      $.ajax({
        type: "get",
        url: window.location.origin + "/remove-from-" + favUrl + $(this).attr("id"),
        success: function success() {
          $('[data-fav-id="' + favId + '"]').removeClass("is-active");
        }
      });
    }
  });
}

var refreshProfileProgress = function refreshProfileProgress(id) {
  $.ajax({
    type: "get",
    url: window.location.origin + "/refresh-profile-progress/" + id,
    success: function success(data) {
      if (data) {
        updateProgressCircle(data);
      }
    }
  });
};

var updateProgressCircle = function updateProgressCircle(obj) {
  var elSvgCircle = $(".prc"),
      elPer = $(".js-percent"),
      value = +obj.value,
      text = obj.text,
      percent = elSvgCircle.attr("stroke-dasharray") * (100 - value) / 100;

  elSvgCircle.animate({
    strokeDashoffset: percent + "px"
  }, 1000);

  elPer.text(value);

  jQuery({ Counter: 0 }).animate({ Counter: elPer.text() }, {
    duration: 1000,
    easing: "swing",
    step: function step() {
      elPer.text(Math.ceil(this.Counter));
    }
  });

  if (value === 100) {
    $(".js-hint").css("display", "none");
  } else {
    $(".js-hint .text").html("Complete" + " " + text);
    $(".js-hint").fadeIn(200);
  }
};

// $(window).load(function() {
//   updateProgressCircle(50);
// });

function animateProgressCircle(animDuration, el) {
  var svg = document.querySelector(el);
  if (svg) {
    var prc = svg.querySelector(".prc");
    var to = 0;
    var from = 125;

    animate({
      duration: animDuration,
      draw: function draw(progress) {
        prc.style.strokeDashoffset = (to - from) * progress + from;
      }
    });
  }

  function animate(_ref) {
    var draw = _ref.draw,
        duration = _ref.duration;

    var start = performance.now();
    requestAnimationFrame(function animate(time) {
      var timeFraction = (time - start) / duration;
      if (timeFraction > 1) timeFraction = 1;
      var progress = timeFraction;
      draw(progress);
      if (timeFraction < 1) {
        requestAnimationFrame(animate);
      }
    });
  }
}

function onHover() {
  var body = document.body,
      timer;

  window.addEventListener("scroll", function () {
    clearTimeout(timer);
    if (!body.classList.contains("disable-hover")) {
      body.classList.add("disable-hover");
    }

    timer = setTimeout(function () {
      body.classList.remove("disable-hover");
    }, 100);
  }, false);
}

function openCatalogItem() {
  $("body").on("click", ".js-open-catalog-item", function (e) {
    e.stopPropagation();
    // console.log(e);
    var current = $(this).attr("data-id");

    if ($(this).hasClass("is-active")) return false;

    $(".js-open-catalog-item").removeClass("is-active");
    $(".catalog-about").fadeOut();

    $(this).addClass("is-active");
    $("#" + current).fadeIn();
    // $(this).toggleClass('is-active').siblings('.js-open-catalog-item').removeClass('is-active');
  });
}

function openCatItem() {
  $("body").on("click", ".js-open-cat-item", function (e) {
    e.stopPropagation();
    // console.log(e);
    var current = $(this).attr("data-id");

    if ($(this).parent().hasClass("is-active")) return false;

    $(".catalog__item").removeClass("is-active");
    $(".catalog-about").fadeOut();

    $(this).parent().addClass("is-active");
    $("#" + current).fadeIn();
    // $(this).toggleClass('is-active').siblings('.js-open-catalog-item').removeClass('is-active');
  });
}

function searchInFaq() {
  var faq = $(".faq");
  var search = document.querySelector(".faq__search");
  var submit = document.querySelector(".faq__submit");

  faq.on("input", ".faq__search input", function (e) {
    if ($(this).val()) {
      search.classList.add("input--width--available");
      $(".faq__submit").fadeIn(300);
      // submit.classList.add('is-visible');
    } else {
      search.classList.remove("input--width--available");
      $(".faq__submit").fadeOut(300);
      // submit.classList.remove('is-visible');
    }
  });
}

function enableMenu() {
  $("body").on("click", function (e) {
    if (e.target.closest(".js-main-menu")) {
      alert("I am work");
      $(".employ-cab__block").toggleClass("is-active");
      $("body").addClass("is-unscrolled");
    } else if (e.target.closest(".employ-cab")) {
      return;
    } else {
      $(".employ-cab__block").removeClass("is-active");
      // $("body").removeClass("is-unscrolled");
    }
  });
}

function initSelects(el) {
  $(el ? el : "" + ".js-select").each(function () {
    $(this).select2({
      width: "100%",
      minimumResultsForSearch: -1,
      dropdownCssClass: "form-dropdown"
    });
  });
}

function initSelects2() {
  $(".js-select").each(function () {
    $(this).select2({
      width: "100%",
      minimumResultsForSearch: -1,
      dropdownCssClass: "form-dropdown"
    });
  });
}

var dropzone = function dropzone() {
  // let checkEl = document.querySelector('.dZUpload__UI');

  var prevContainer = document.querySelector(".resume__pview");
  var previewTemplate = "\n    <div class=\"resume__preview\" id=\"myDzPreview\">\n        <div class=\"resume__preview-img\"><img data-dz-thumbnail></div>\n        <div class=\"resume__preview-block\"><span class=\"resume__preview-name\" data-dz-name></span>\n        <button class=\"resume__preview-remove\" data-dz-remove></button>\n        </div>\n    </div>\n   ";

  // if (checkEl != null) {

  Dropzone.autoDiscover = false;

  $(".js-dropzone").each(function (i, el) {
    var myDropzone = new Dropzone(el, {
      url: "/",
      // autoProcessQueue: true,
      // addRemoveLinks: true,
      // parallelUploads: 10,
      // addRemoveLinks:true,
      uploadMultiple: true,
      previewsContainer: prevContainer,
      previewTemplate: previewTemplate,
      // uploadMultiple: true,
      // queueComplete: false,
      init: function init() {
        this.on("complete", function (file) {
          if (this.getUploadingFiles().length === 0 && this.getQueuedFiles().length === 0) {
            hidePortfolioEl();
          }
        });
      }
    });
  });
};

var dropzoneDocument = function dropzoneDocument() {
  var prevContainer = document.querySelector(".documents__preview");
  var el = document.querySelector(".js-dropzone-document");
  var previewTemplate = "\n    <div class=\"d-preview\" id=\"myDzPreview\">\n        <span class=\"d-preview__name\" data-dz-name></span>\n        <button class=\"d-preview__remove\" data-dz-remove></button>\n    </div>\n   ";

  var mock_file = {
    name: "myfile.png",
    size: 10000
  };

  Dropzone.autoDiscover = false;

  if (el) {
    var myDropzone = new Dropzone(el, {
      url: "/",
      // autoProcessQueue: true,
      // addRemoveLinks: true,
      // parallelUploads: 10,
      // addRemoveLinks:true,
      uploadMultiple: true,
      previewsContainer: prevContainer,
      previewTemplate: previewTemplate,
      // uploadMultiple: true,
      // queueComplete: false,
      init: function init() {
        this.on("complete", function (file) {
          if (this.getUploadingFiles().length === 0 && this.getQueuedFiles().length === 0) {
            hidePortfolioEl();

            var a = document.createElement("a");
            a.className = "d-preview__download";
            a.setAttribute("href", file.url);
            a.setAttribute("target", "_blank");
            file.previewTemplate.appendChild(a);
          }

          // const a = document.createElement('a');
          // a.setAttribute('href', file.url);
          // a.setAttribute('target', "_blank");
          // a.innerHTML = "Prenos";
          // file.previewTemplate.appendChild(a);
        });

        this.emit("addedfile", mock_file);
        this.emit("complete", mock_file);
      }
    });
  }
};

var hidePortfolioEl = function hidePortfolioEl() {
  var rPreviews = $(".resume__preview");

  rPreviews.each(function (i) {
    if (i > 2) {
      $(this).fadeOut();
    }
  });
};

function enableMenu() {
  $("body").on("click", function (e) {
    if (e.target.closest(".js-main-menu")) {
      $(".employ-cab__block").toggleClass("is-active");
      $(".js-burger").removeClass("is-active");
      $(".js-mob-menu").removeClass("is-active");
      $("body").toggleClass("is-unscrolled");
    } else if (e.target.closest(".employ-cab")) {
      return;
    } else {
      $(".employ-cab__block").removeClass("is-active");
    }
  });
}

var showPortfolioEl = function showPortfolioEl() {
  $("body").on("click", ".resume__show-all", function (e) {
    e.preventDefault();
    var rPreviews = $(".resume__preview");
    console.log($(this).text());

    if (!$(this).text().includes("Close")) {
      $(this).text("- Close all");

      rPreviews.each(function (i) {
        //   alert("I am work");
        if (i > 2) {
          $(this).fadeIn();
        }
      });
    } else {
      $(this).text("+ View all");
      hidePortfolioEl();
    }
  });
};

var viewAllSertificates = function viewAllSertificates() {
  var sertificates = $(".catalog-about__portfolio-item");

  sertificates.each(function (i) {
    if (i > 1) {
      $(this).fadeOut();
    }
  });

  $(".catalog-about__portfolio-count").text("(" + (sertificates.length - 2) + ")");

  $("body").on("click", ".js-view-all", function (e) {
    e.preventDefault();

    $(this).fadeOut();

    sertificates.each(function (i) {
      if (i > 1) {
        $(this).fadeIn();
      }
    });
  });
};

function companySlider(timing) {
  var track = document.querySelector(".js-company-slider");
  $(".js-company-slider").carousel({
    interval: timing
  });
  animateProgressCircle(timing, ".block--vacancies-slider .progress");
  $(".js-company-slider").on("slide.bs.carousel", function (e) {
    animateProgressCircle(timing, ".block--vacancies-slider .progress");
  });
}

function circleProgressSlider(timing, el, circleEl) {
  var track = document.querySelector(el);
  $(el).carousel({
    interval: timing
  });
  animateProgressCircle(timing, circleEl);
  $(el).on("slide.bs.carousel", function (e) {
    animateProgressCircle(timing, circleEl);
  });
}

function enableCollapse() {
  $("body").on("click", ".js-collapse-btn", function () {
    if ($(this).siblings(".js-collapse")) {
      $(this).toggleClass("is-collapsed").siblings(".js-collapse").slideToggle(300);
    }
  });
}

function footerSubscript() {
  $(".footer__subscription-form").on("click", ".subscription__submit", function (e) {
    e.preventDefault();
    var msg = "<p class='h4 subscription__message'>Thank you for subscription to our newsmail!<p>";
    var tmp = $(".footer__subscription-form")[0].innerHTML;
    setTimeout(function () {
      $(".footer__subscription-form")[0].innerHTML = tmp;
    }, 3000);
    $(".footer__subscription-form")[0].innerHTML = msg;
  });
}

var innerPopup = function innerPopup() {
  $("[data-ipopup]").on("click", function (e) {
    // e.stopPropagation();
    // e.preventDefault();

    var name = $(this).attr("data-ipopup");

    if ($(window).width() < 1280) {
      $(".inner-popup").parents(".inner-page__right").fadeOut().addClass("is-active");
      $(".inner-popup").fadeOut();
      $("#" + name).parents(".inner-page__right").fadeIn().addClass("is-active");
      $("#" + name).fadeIn();
    } else {
      $(".inner-popup").fadeOut();
      $("#" + name).fadeIn();
    }
  });

  $(".js-ipopup-close").on("click", function () {
    if ($(window).width() < 1280) {
      $(".inner-popup").parents(".inner-page__right").fadeOut().removeClass("is-active");
      $(".inner-popup").fadeOut();
    } else {
      $(".inner-popup").fadeOut();
    }
  });
};

var addCoverLetter = function addCoverLetter() {
  $("body").on("click", ".apply__btn", function (e) {
    e.preventDefault();

    if (!$(this).hasClass("apply__btn--remove")) {
      $(this).addClass("apply__btn--remove");
      $(this).text("Remove cover letter");
      $(".apply__form").slideDown(200);
    } else {
      $(".apply__form").slideUp(200);
      $(this).removeClass("apply__btn--remove");
      $(this).text("+ Add a cover letter");
    }
  });
};

var openEducationForm = function openEducationForm() {
  $(".resume__block-edu-btn").on("click", function () {
    $(".resume__block-edu-row").fadeOut(100);
    $(".resume__block-edu-form .form__content").slideDown(300);
  });
};

var handleEduBlocks = function handleEduBlocks() {
  $(".js-add-edu-block").on("click", function () {
    var blocks = [].concat(_toConsumableArray(document.querySelectorAll(".js-edu-block")));
    var block = blocks[blocks.length - 1];

    [].concat(_toConsumableArray(block.querySelectorAll("select"))).forEach(function (item) {
      $(item).select2("destroy");
      return item;
    });

    var newBlock = block.cloneNode(true);
    [].concat(_toConsumableArray(newBlock.querySelectorAll("input"))).forEach(function (item) {
      item.value = "";
      return item;
    });

    [].concat(_toConsumableArray(block.querySelectorAll("select"))).forEach(function (item) {
      initSelects(item);
      return item;
    });

    block.parentNode.insertBefore(newBlock, block.nextSibling);
    [].concat(_toConsumableArray(newBlock.querySelectorAll("select"))).forEach(function (item) {
      initSelects(item);
      return item;
    });
  });

  $("body").on("click", ".js-del-edu-block", function () {
    var blocks = [].concat(_toConsumableArray(document.querySelectorAll(".js-edu-block")));
    var block = this.parentNode;

    if (blocks.length > 1) {
      block.parentNode.removeChild(block);
    } else {
      $(".resume__block-edu-form .form__content").fadeOut(300);
      $(".resume__block-edu-row").slideDown(300);
    }
  });
};

var submitProfileForms = function submitProfileForms(e) {
  $("body").on("click", ".js-form-submit", function (e) {
    submitProfilePreferencesForm(this);
  });
};

var delForm = function delForm(el) {
  if (el) {
    // console.log(el);
    var form = $(el).parents(".js-resume-block").find(".js-edit-form");
    var ready = $(el).parents(".js-resume-block").find(".js-resume-ready-block");

    TweenMax.to($(form), 0.4, {
      y: 100,
      opacity: 0,
      height: 0,
      display: "none"
    });

    TweenMax.fromTo($(ready), 0.4, {
      opacity: 0,
      display: "none",
      height: 0
    }, {
      y: 0,
      height: "auto",
      display: "flex",
      opacity: 1,
      visibility: "visible"
    });
  }
};

var autoComplete = function autoComplete() {
  var cities = ["Saint-Petersburg", "Moscow", "Roma", "Peking", "London", "Quay", "Saint-Petersburg", "Moscow", "Roma", "Peking", "London", "Quay", "Saint-Petersburg", "Saint-Petersburg", "Saint-Petersburg", "Saint-Petersburg", "Saint-Petersburg", "Saint-Petersburg", "Saint-Petersburg", "Saint-Petersburg", "Saint-Petersburg"];

  $(".js-autocomplete .input__control").each(function () {
    $(this).autocomplete({
      source: cities
    });
  });
};

function galleryInit(timing) {
  var gallery = document.querySelector(".js-gallery");

  if (gallery) {
    var items = gallery.querySelectorAll(".slider__item");
    var qty = items.length;
    $(".js-gallery").carousel({
      interval: timing
    });
    var current = 1;
    $("#slider-current").html(current + " / " + qty);
    $(".js-gallery").on("slide.bs.carousel", function (e) {
      items.forEach(function (item, idx) {
        if (item.classList.contains("active")) {
          current = idx + 1;
        }
      });
      $("#slider-current").html(current + " / " + qty);
    });
    $(".slider__prev").click(function () {
      $(".js-gallery").carousel("prev");
    });
    $(".slider__next").click(function () {
      $(".js-gallery").carousel("next");
    });
  }
}

var validateForm = function validateForm() {
  if ($(".js-validate").length > 0) {
    // alert('I am validate')
    $(".js-validate").each(function () {
      $(this).validate({
        errorClass: "form__err",
        rules: {
          password: "required",
          email: {
            required: true,
            email: true
          }
        },

        messages: {
          password: "Вводите правильный емаил",
          email: "Вводите правильный пароль"
        },

        submitHandler: function submitHandler() {
          handlingSendingData();
        },

        invalidHandler: function invalidHandler(form, validator) {
          // console.log(form, validator);

          console.log($(validator.currentForm).find(".form__err"));
          // // alert('i am work')
          // console.log($('.js-form').next())
          //     // $('.input__control').each(function() {
          //     //     $(this).next().css('background', 'red');
          //     // })

          // $(validator.currentForm).find('.input').each(function() {
          //     $(this).css('padding', '0px');
          // });
        }
      });
    });
  }

  return false;
};

var handlingSendingData = function handlingSendingData() {
  var formData = $(".js-form").serialize();
  $.ajax({
    url: "/",
    data: formData,
    type: "POST",
    dataType: "json",
    success: function success(data) {
      console.log(data);
      if (data.status >= 200 && data.status <= 300) {
        alert("Письмo oтпрaвлeнo!");
      } else {
        alert("Письмo не oтпрaвлeнo!");
      }
    },
    error: function error(data) {
      $(".js-err").addClass("is-visible");
      // // alert('Вашие данные не правильно! Вводите правильные данные');
      // alert('Error ' + data.status);
    }
  });
};

var getPosFilterBtn = function getPosFilterBtn() {
  var checkboxValues = JSON.parse(localStorage.getItem("checkboxValues")) || {},
      checks = $(".filters .checkbox__control");
  var data = {};

  checks.each(function (i) {
    $(this).attr("data-checked", i);

    $(this).on("change", function () {
      // const posTop = $(this).parent().offset().top - $(this).parents('.filters').offset().top;

      data.id = $(this).attr("id");

      if ($(this).is(":checked")) {
        $(this).attr("checked", "checked");

        data.value = 1;

        checkboxValues[i] = $(this).prop("checked");

        localStorage.setItem("checkboxValues", JSON.stringify(checkboxValues));
      } else {
        $(this).removeAttr("checked");

        data.value = 0;

        var delItem = $(this).attr("data-checked");
        delete checkboxValues[delItem];

        localStorage.setItem("checkboxValues", JSON.stringify(checkboxValues));
      }

      console.log(data);

      $.ajax({
        type: "POST",
        url: "/",
        data: data,
        success: function success(data) {
          console.log(data);
        }
      });

      // setTimeout(() => {
      //   $(this)
      //     .parents(".filters")
      //     .submit();
      // }, 300);
    });
  });

  $.each(checkboxValues, function (key, value) {
    $("[data-checked = '" + key + "'").prop("checked", value);
  });
};

var delLetterTemplate = function delLetterTemplate() {
  $("body").on("click", ".js-del-temp", function () {
    console.log(this);
    $(this).parents(".resume__block").remove();
  });
};

var mobMenu = function mobMenu() {
  $(".js-burger").on("click", function () {
    // alert(" I am work")
    $(this).toggleClass("is-active");
    $(".js-mob-menu").toggleClass("is-active");
    $("body").toggleClass("is-unscrolled");
  });
};

var profileCompleteHint = function profileCompleteHint() {
  $(".js-hint").on("click", ".js-hint-close", function () {
    $(".js-hint").fadeOut(200);
  });

  //   $(".profile-complete__progress").on(
  //     "click",
  //     ".profile-complete__circle",
  //     function() {
  //       $(".profile-complete__progress .js-hint").fadeIn(200);
  //     }
  //   );
};

var mobFilter = function mobFilter() {
  $("body").on("click", ".js-mob-filter", function () {
    var txt = $(this).text();
    // console.log(txt);
    if (txt === "Filters") {
      $(this).text("Show");
      $(this).parent().find(".inner-page__sidebar").addClass("is-showed");
      $("body").addClass("is-unscrolled");
    } else {
      $(this).text("Filters");
      $(this).parent().find(".inner-page__sidebar").removeClass("is-showed");
      $("body").removeClass("is-unscrolled");
    }
  });
};

var mobFaq = function mobFaq() {
  $("body").on("click", ".js-mob-faq", function () {
    var txt = $(this).text();
    // console.log(txt);
    if (txt === "Menu") {
      $(this).text("Questions");
      $(this).parent().find(".inner-page__sidebar").addClass("is-showed");

      $("body").addClass("is-unscrolled");
    } else {
      $(this).text("Menu");
      $(this).parent().find(".inner-page__sidebar").removeClass("is-showed");
      $("body").removeClass("is-unscrolled");
    }
  });
};

var btnMob = function btnMob() {
  $("body").on("click", ".js-btn-mob", function () {
    var txt = $(this).text();
    // console.log(txt);
    if (txt.includes("Menu") > 0) {
      $(this).text("Close");
      $(this).parent().find(".inner-page__sidebar").addClass("is-showed");

      $("body").addClass("is-unscrolled");
    } else {
      $(this).text("Menu");
      $(this).parent().find(".inner-page__sidebar").removeClass("is-showed");
      $("body").removeClass("is-unscrolled");
    }
  });
};

var changeButtonName = function changeButtonName() {
  if ($(window).width() < 768) {
    var text = $(".cat-card__request").text();
    console.log(text);
    if (text.includes("request")) {
      text = "Request";
      $(".cat-card__request").text(text);
    }
  }
};

// const addSelect = () => {
//   $("body").on("click", ".js-add-select", function() {
//     // const itm = $(this)
//     //   .prev()
//     //   .find(".form__select");
//     // console.log(itm);
//     // const cln = itm.clone();
//     // $(cln).select2("destroy");
//     // initSelects(cln);
//     // console.log(cln);
//     // cln[0].insertBefore($(this));
//   });
// };

var popup = function popup() {
  $("[data-popup]").on("click", function () {
    var name = $(this).attr("data-popup");

    $(".popup").removeClass("popup--opened");

    $("#" + name).addClass("popup--opened");

    $("body").addClass("is-unscrolled");

    return false;
  });

  $(".popup__overlay").on("click", function () {
    $(".popup").removeClass("popup--opened");

    $("body").removeClass("is-unscrolled");
  });
};

var jsDel = function jsDel() {
  $(".js-del").on("click", function () {
    $(".popup").removeClass("popup--opened");

    $("body").removeClass("is-unscrolled");
  });
};

var jsCancel = function jsCancel() {
  $(".js-cancel").on("click", function () {
    $(".popup").removeClass("popup--opened");

    $("body").removeClass("is-unscrolled");
  });
};

function submitProfileSummaryForm() {
  var form = $("#add_edit_profile_summary");
  $.ajax({
    url: form.attr("action"),
    type: form.attr("method"),
    data: form.serialize(),
    dataType: "json",
    success: function success(json) {
      $("#additional_form").html(json.html);
      //$("#success_summary").html("<div class='alert alert-success'>{{__('Summary updated successfully')}}</div>");
    },
    error: function error(json) {}
  });
}

var handleVacancyForm = function handleVacancyForm() {
  $(".js-create-vacancy").on("click", function (e) {
    e.preventDefault();
    var self = $(".js-create-vacancy");

    var form = $(self).parents(".js-catalog").find(".js-catalog-form");
    var ready = $(self).parents(".js-catalog").find(".js-catalog-inner");

    //   console.log(form);
    //   console.log(ready);

    TweenMax.fromTo($(form), 0.4, {
      y: 100
    }, {
      y: 0,
      opacity: 1,
      height: "auto",
      display: "block",
      visibility: "visible"
    });

    TweenMax.fromTo($(ready), 0.4, {
      opacity: 1,
      display: "block",
      height: 0
    }, {
      y: 0,
      height: "0",
      display: "none",
      opacity: 0,
      visibility: "hidden"
    });

    $(".js-create-vacancy").css("display", "none");
  });

  $(".js-form-cancel").on("click", function (e) {
    e.preventDefault();
    var self = $(".js-form-cancel");

    var form = $(self).parents(".js-catalog").find(".js-catalog-form");
    var ready = $(self).parents(".js-catalog").find(".js-catalog-inner");

    TweenMax.to($(form), 0.4, {
      y: 0,
      opacity: 0,
      height: 0,
      display: "none",
      visibility: "hidden"
    });

    TweenMax.fromTo($(ready), 0.4, {
      y: 100,
      opacity: 0,
      display: "none",
      height: 0
    }, {
      y: 0,
      height: "auto",
      display: "block",
      opacity: 1,
      visibility: "visible"
    });

    $(".js-create-vacancy").css("display", "block");
  });
};

var handleCardForms = function handleCardForms() {
  $("body").on("click", ".js-card-edit", function (e) {
    e.stopPropagation();
    e.preventDefault();
    var self = $(this);
    var id = self.attr("data-id");
    var form = $("#" + id);
    var ready = $(self).parents(".js-cat-card");

    TweenMax.fromTo($(form), 0.4, {
      y: 100
    }, {
      y: 0,
      opacity: 1,
      height: "auto",
      display: "block",
      visibility: "visible"
    });

    TweenMax.fromTo($(ready), 0.4, {
      opacity: 1,
      display: "block",
      height: 0
    }, {
      y: 0,
      height: "0",
      display: "none",
      opacity: 0,
      visibility: "hidden"
    });
  });

  $(".js-cForm-cancel").on("click", function (e) {
    e.preventDefault();
    var self = $(this);

    var form = $(self).parents(".catalog__item-form");

    var ready = $(self).parents(".catalog__item").find(".js-cat-card");

    console.log(form, ready);

    TweenMax.to($(form), 0.4, {
      y: 0,
      opacity: 0,
      height: 0,
      display: "none",
      visibility: "hidden"
    });

    TweenMax.fromTo($(ready), 0.4, {
      y: 100,
      opacity: 0,
      display: "none",
      height: 0
    }, {
      y: 0,
      height: "auto",
      display: "block",
      opacity: 1,
      visibility: "visible"
    });
  });
};